# Exploiting NIST Vulnerabilities in Legacy Applications

Applications with known vulnerabilities can pose a wide range of threats to an orginization. Including security breaches, 
data loss, malware installation, and unauthorized access.

Controlling application installations is a core part of organization security. The organization within this lab has organization policies in place that 
users are not permitted to install applications. However, we all know that security policies are routinley broken.
We will be referncing NIST to discover any vulnerabilities accosieted with a unauthorized installation.

## Discover A Recently Installed Application

In this case these was an unpermitted installation of Adobe Reader on a users machine. I will be conducting reconasanse to 
understand any risks that may now be precent on the device.

First I need to find what exact version of the application is installed. A quick journey to the 'help' section of the Adobe Reader
show that it is running version 8.1.1

<img width="878" height="450" alt="image" src="https://github.com/user-attachments/assets/c41fc2f8-ead2-4c38-b5da-5412293943b7" />

I can now use this version number to refence any known vulenarbilities through NIST.

On the Nist.gov website we find an associted vulnerabilities within Adobe Reader 8.1.1

<img width="854" height="560" alt="image" src="https://github.com/user-attachments/assets/4175215e-87cf-415d-9c06-976c24ecb143" />

The vulnerability within this application is rated as 9.3 on the CVSS! This indicates a critical vulnerability.

And if we look a little deeper in the NIST documentation we can confirm that 8.1.1 is affected by this critical vulnerability.

<img width="854" height="201" alt="image" src="https://github.com/user-attachments/assets/c5b365f3-a5d7-4eb8-b4a7-b530276712a7" />

#### **At this point is would be appropriate to uninstall the application and investigate how this installation was put on this computer.**
#### **But for the purposes of this lab we wil be simulating an attack on the application for proof on concept.**

## Simulate An Attack On The Vulnerable Application

To expoilt this vulnerability we will be using Kali Linux(purple).
More specifically we will be use the metasploit tool.

Within a Kali Linux terminal we boot up metasploit and search for the Adobe version.

<img width="1141" height="726" alt="image" src="https://github.com/user-attachments/assets/2a1cf71a-bdc6-421e-bd3f-05a4856ad020" />

We see that the vulnerability is part of metasploit and can be exploited. I will now go into the payload options for the vulnerability with metasploit
to view all of the associted payloads.

<img width="818" height="408" alt="image" src="https://github.com/user-attachments/assets/820c010a-a66a-441d-878e-7fa32ef1c828" />

As simple exploit command will now create a malicious PDF that can be used to test this vulnerability.

<img width="530" height="73" alt="image" src="https://github.com/user-attachments/assets/7754ba06-8c0c-4333-ab78-7fc43face51b" />

Once we have out malicious PDF we need to get it onto the users machine. I exit metasploit in the terminal and issue the following
command to copy the malicious PDF to the user folder on the machine "cp /home/aciaadmin/.msf4/local/msf.pdf ."

Next I copy the malicious PDF and paste it onto the users machine with the exploitable version of Adobe Reader. While I can easily do 
this through admin permission an attacker would have to send the user a phishing email or similar attack to get the PDF onto the vulnerable machine.

<img width="836" height="303" alt="image" src="https://github.com/user-attachments/assets/0812abec-9ca0-433b-ab49-31e6324d3579" />

Finally I open the malicious PDF with Adobe Reader 8.1.1... exploiting the vulnerability within the legacy software.

While this vulnerability wont fully take effect as it requires the software to be running on the Windows XP operating systems(the
machine being used is Windows 11), we can still see the indcators of attack that occured when we opened the file.


## Obserce Indicators Of Attack

To see the effects of opening the malicous PDF we be reviwing the Event Viewer logs of the effected machine.

Within the Widows Application logs of the Event Viewer we can see the error messages from attempting to open the malicious PDF.

<img width="948" height="886" alt="image" src="https://github.com/user-attachments/assets/ae47e32d-b86b-4fe7-a07a-49223e48340c" />

**Note that even though the exploit was not successful due to the operating system version, these errors still shows us a strong indicator of attack.**
This would still raise alarm in any orginization that an attacker was able to deliver a malicous PDF to a user device and they even attempted to open it.
These are both significant security issues.


